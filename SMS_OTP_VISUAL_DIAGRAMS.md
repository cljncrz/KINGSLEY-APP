# ğŸ“Š SMS OTP Implementation - Visual Diagrams & Flow Charts

## 1. User Journey Flow

```
START
  â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                  SIGNUP SCREEN                          â”‚
  â”‚                                                          â”‚
  â”‚  Enter:                                                 â”‚
  â”‚  â”œâ”€ Full Name: [_______________________]               â”‚
  â”‚  â”œâ”€ Email: [_________________________]                  â”‚
  â”‚  â”œâ”€ Phone: [_________________________]                  â”‚
  â”‚  â”œâ”€ Password: [_____________________]                   â”‚
  â”‚  â”œâ”€ Confirm: [_____________________]                    â”‚
  â”‚  â”‚                                                      â”‚
  â”‚  â””â”€ â˜‘ï¸ Accept Privacy & Terms                           â”‚
  â”‚     [CREATE ACCOUNT BUTTON]                            â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                â”‚\n                â”‚ Click \"Create Account\"\n                â”‚ â†“\n        â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\n        â•‘  Firebase validates â”‚\n        â•‘  phone number       â”‚\n        â•‘  & sends SMS        â”‚\n        â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n                â”‚\n                â”‚ SMS sent (5-30 sec)\n                â”‚ â†“\n        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n        â”‚  OTP VERIFICATION SCREEN                 â”‚\n        â”‚                                          â”‚\n        â”‚  \"Enter code sent to +1-555-123-4567\"  â”‚\n        â”‚                                          â”‚\n        â”‚  [ 6 ] [ 6 ] [ 6 ] [ 6 ] [ 6 ] [ 6 ]  â”‚\n        â”‚   â–²    â–²    â–²    â–²    â–²    â–²           â”‚\n        â”‚   â””â”€ Auto-advances as you type â”€â”˜      â”‚\n        â”‚                                          â”‚\n        â”‚  [VERIFY BUTTON]  Resend in 25s...     â”‚\n        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                â”‚\n                â”‚ Enter 6 digits\n                â”‚ â†“\n        â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\n        â•‘  Firebase verifies  â”‚\n        â•‘  OTP code           â”‚\n        â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n                â”‚\n                â”œâ”€â†’ INVALID â”€â”€â†’ âŒ Error: \"Invalid code\"\n                â”‚               Retry\n                â”‚\n                â””â”€â†’ VALID â”€â”€â†’ âœ… Code verified\n                              â”‚\n                              â–¼\n                    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\n                    â•‘  Save user profile  â”‚\n                    â•‘  to Firestore       â”‚\n                    â•‘  Create notificationâ”‚\n                    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n                              â”‚\n                              â–¼\n                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n                    â”‚  SUCCESS SCREEN      â”‚\n                    â”‚  \"Account Created!\"  â”‚\n                    â”‚  \"Redirecting...\"    â”‚\n                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                              â”‚\n                              â–¼\n                    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\n                    â•‘  User logged in     â”‚\n                    â•‘  Redirect to home   â”‚\n                    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n                              â”‚\n                              â–¼\n                            END âœ…\n```\n\n---\n\n## 2. Firebase Phone Authentication Flow\n\n```\nClient App                    Firebase                    Carrier\n    â”‚                             â”‚                           â”‚\n    â”‚  verifyPhoneNumber()       â”‚                           â”‚\n    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º   â”‚                           â”‚\n    â”‚                             â”‚  Generate 6-digit code    â”‚\n    â”‚                             â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚\n    â”‚                             â”‚                           â”‚\n    â”‚                             â”‚  Send SMS to user         â”‚\n    â”‚                             â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚\n    â”‚                             â”‚                           â”‚\n    â”‚                             â”‚  SMS received âœ“           â”‚\n    â”‚â—„â”€â”€â”€â”€â”€â”€ codeSent event â”€â”€â”€â”€â”€â”‚                           â”‚\n    â”‚                             â”‚                           â”‚\n    â”‚  User enters OTP            â”‚                           â”‚\n    â”‚  signInWithCredential()     â”‚                           â”‚\n    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º   â”‚                           â”‚\n    â”‚                             â”‚  Verify code             â”‚\n    â”‚                             â”‚  (Check against DB)       â”‚\n    â”‚                             â”‚                           â”‚\n    â”‚  User credential âœ“         â”‚                           â”‚\n    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚                           â”‚\n    â”‚                             â”‚                           â”‚\n    â”‚  Save to Firestore         â”‚                           â”‚\n    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º   â”‚                           â”‚\n    â”‚                             â”‚  Create user doc         â”‚\n    â”‚                             â”‚                           â”‚\n    â”‚  User data saved âœ“         â”‚                           â”‚\n    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚                           â”‚\n    â”‚                             â”‚                           â”‚\n    â”œâ”€â–º Navigate to Home         â”‚                           â”‚\n    â”‚                             â”‚                           â”‚\n    â””â”€ User logged in âœ“          â”‚                           â”‚\n```\n\n---\n\n## 3. Data Structure & Firestore Schema\n\n```\n                         FIRESTORE DATABASE\n                                 â”‚\n                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n                    â”‚                         â”‚\n              Collections              Documents\n                    â”‚                         â”‚\n              â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”\n              â”‚   users    â”‚          â”‚   userId123   â”‚\n              â”‚ collection â”‚         â”‚   document    â”‚\n              â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                    â”‚                       â”‚\n             â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚\n             â”‚                 â”‚            â”‚\n      â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚\n      â”‚ userId123     â”‚  â”‚ userId456     â”‚ â”‚\n      â”‚ document      â”‚  â”‚ document      â”‚ â”‚\n      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚\n             â”‚                             â”‚\n             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                       â”‚\n          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n          â”‚                                     â”‚\n     Fields (Keys)                         Values\n          â”‚                                     â”‚\n    â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚\n    â”‚               â”‚                         â”‚\nfullName       \"John Doe\"                     â”‚\nemail          \"john@example.com\"            â”‚\nphoneNumber    \"555-123-4567\"  â—„â”€â”€â”€â”€â”€ Phone from signup\nphoneVerified  true             â—„â”€â”€â”€â”€â”€ NEW FLAG\nfcmToken       \"token_xyz\"                    â”‚\nrole           \"user\"                        â”‚\ncreatedAt      \"2024-11-25T...\"              â”‚\n    â”‚               â”‚                         â”‚\n    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n             Firestore Structure\n```\n\n---\n\n## 4. State Machine: OTP Verification\n\n```\n                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n                    â”‚   IDLE STATE    â”‚\n                    â”‚  (Waiting for   â”‚\n                    â”‚   input)        â”‚\n                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                             â”‚\n               User enters 6 digits\n                             â”‚\n                             â–¼\n                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n                    â”‚ VALIDATING      â”‚\n                    â”‚ (Checking with  â”‚\n                    â”‚  Firebase)      â”‚\n                    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜\n                         â”‚        â”‚\n              Valid â—„â”€â”€â”€â”€â”€â”˜        â””â”€â–º Invalid\n                 â”‚                      â”‚\n                 â–¼                      â–¼\n        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n        â”‚ SUCCESS STATE   â”‚   â”‚ ERROR STATE     â”‚\n        â”‚ (Verified)      â”‚   â”‚ (Wrong code)    â”‚\n        â”‚                 â”‚   â”‚                 â”‚\n        â”‚ - Save data     â”‚   â”‚ - Show error    â”‚\n        â”‚ - Login user    â”‚   â”‚ - Retry allowed â”‚\n        â”‚ - Redirect      â”‚   â”‚   (max 5)       â”‚\n        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                                       â”‚\n                              Max retries?\n                                   â”‚\n                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n                    â”‚                             â”‚\n                   NO                           YES\n                    â”‚                             â”‚\n                    â–¼                             â–¼\n            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n            â”‚ IDLE STATE      â”‚       â”‚ EXPIRED STATE   â”‚\n            â”‚ (Accept retry)  â”‚       â”‚ (Session exp.)  â”‚\n            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚                 â”‚\n                                      â”‚ - Show error    â”‚\n                                      â”‚ - Restart       â”‚\n                                      â”‚   signup        â”‚\n                                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n---\n\n## 5. API Calls Timeline\n\n```\nTime  Action                       Duration    Response\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n0ms   User clicks \"Create\"        â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n      â”œâ”€ Validate form            ~100ms\n      â”œâ”€ Format phone             ~50ms\n      â””â”€ Call Firebase API        â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n                                           â”‚\n100ms â”€ Firebase processes        â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€\n      â”œâ”€ Generate 6-digit code   ~200ms â”‚\n      â””â”€ Send SMS                â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n\n300ms                             â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n                           SMS IN TRANSIT\n      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n      (5-30 seconds typical)\n\n5-30s â”€ SMS arrives on phone     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n      â”œâ”€ User reads code\n      â””â”€ User enters digits       â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n\n30-60s User enters 6 digits      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n      â”œâ”€ Each digit entered       ~100ms each\n      â””â”€ Triggers verify on       ~2000ms\n          complete\n\n62s   Firebase verifies code     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n      â”œâ”€ Check code              ~100ms\n      â”œâ”€ Create credential       ~200ms\n      â”œâ”€ Sign in user            ~500ms\n      â””â”€ Save to Firestore       ~1000ms\n                                           â”‚\n63.8s â”€ Success                  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n      â”œâ”€ Navigate screen         ~300ms\n      â””â”€ Display success         â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n\n64s   Total: ~64 seconds (typical)\n```\n\n---\n\n## 6. Error Handling Flow\n\n```\n                        User Action\n                             â”‚\n                             â–¼\n                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n                    â”‚ Try operation    â”‚\n                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                             â”‚\n                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”\n                    â”‚                 â”‚\n                   âœ“                  âœ—\n              Success            Exception\n                    â”‚                 â”‚\n                    â–¼                 â–¼\n              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n              â”‚Proceed to  â”‚  â”‚ Catch error     â”‚\n              â”‚next step   â”‚  â”‚ & classify      â”‚\n              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                                       â”‚\n                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n                    â”‚                  â”‚                  â”‚\n                FirebaseAuthException  NetworkException   Other\n                    â”‚                  â”‚                  â”‚\n                    â–¼                  â–¼                  â–¼\n           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n           â”‚ Check error    â”‚  â”‚ Show:        â”‚  â”‚ Show:        â”‚\n           â”‚ code           â”‚  â”‚ \"Network     â”‚  â”‚ \"Unknown     â”‚\n           â”‚                â”‚  â”‚  error\"      â”‚  â”‚  error\"      â”‚\n           â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                    â”‚\n     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n     â”‚              â”‚              â”‚              â”‚\n  \"invalid\"  \"too-many\"   \"session\"   \"Other\"\n  \"code\"     \"requests\"   \"expired\"   errors\n     â”‚              â”‚              â”‚              â”‚\n     â–¼              â–¼              â–¼              â–¼\n  Show:         Show:          Show:          Show:\n  \"Please       \"Too many      \"Code has      Generic\n   try         attempts.      expired.       error +\n   again\"      Try later.\"    Restart.\"     code\n```\n\n---\n\n## 7. Timer Countdown Visual\n\n```\nOTP Screen State Over Time:\n\nSecond 0-30:\n  \"Resend in 30s\"  â±ï¸ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n   (Button DISABLED)\n\nSecond 10:\n  \"Resend in 20s\"  â±ï¸ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n   (Button DISABLED)\n\nSecond 20:\n  \"Resend in 10s\"  â±ï¸ â”€â”€â”€â”€â”€â”€â”€â”€\n   (Button DISABLED)\n\nSecond 25:\n  \"Resend in 5s\"   â±ï¸ â”€â”€â”€â”€â”€\n   (Button DISABLED)\n\nSecond 30:\n  \"Didn't receive code? Resend\"  âœ… ENABLED\n   [RESEND BUTTON] (Button ENABLED)\n\nAfter click Resend:\n  \"Resend in 30s\"  â±ï¸ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n   (Button DISABLED again)\n```\n\n---\n\n## 8. Security Timeline\n\n```\nCODE GENERATION: t=0\n   â””â”€ 6-digit code: 123456\n   â””â”€ Expires at: t + 3600 seconds (1 hour)\n\nFIRST VERIFICATION ATTEMPT: t=30\n   â”œâ”€ User enters: 123456\n   â”œâ”€ Firebase validates: âœ“ Match\n   â”œâ”€ Code age: 30 seconds < 3600 âœ“\n   â””â”€ Result: âœ“ VERIFIED\n\nLATE VERIFICATION: t=3700 (after 1 hour)\n   â”œâ”€ User tries to verify\n   â”œâ”€ Firebase checks: Code age 3700 > 3600\n   â””â”€ Result: âœ— EXPIRED - Restart signup\n\nMULTIPLE WRONG ATTEMPTS:\n   Attempt 1 @ t=35: Wrong code âœ—\n   Attempt 2 @ t=45: Wrong code âœ—\n   Attempt 3 @ t=55: Wrong code âœ—\n   Attempt 4 @ t=65: Wrong code âœ—\n   Attempt 5 @ t=75: Wrong code âœ—\n   Attempt 6 @ t=85: BLOCKED! Too many attempts\n\nRESEND TOKEN RATE LIMITING:\n   Resend 1 @ t=30: OK âœ“\n   Resend 2 @ t=32: Blocked (too soon)\n   Resend 3 @ t=60: OK âœ“ (30 sec elapsed)\n   Resend 4 @ t=61: Blocked (too soon)\n```\n\n---\n\n## 9. Component Interaction Diagram\n\n```\n                    KINGSLEY APP\n        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n        â”‚                                â”‚\n    â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”\n    â”‚ Signup Screen   â”‚      â”‚ OTP Verify Scr   â”‚\n    â”‚                 â”‚      â”‚                  â”‚\n    â”‚ â€¢ Get name      â”‚      â”‚ â€¢ Display 6 flds â”‚\n    â”‚ â€¢ Get email     â”‚      â”‚ â€¢ Auto-advance   â”‚\n    â”‚ â€¢ Get phone  â—„â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¤ â€¢ Verify OTP     â”‚\n    â”‚ â€¢ Get password  â”‚      â”‚ â€¢ Resend button  â”‚\n    â”‚ â€¢ Validate form â”‚      â”‚ â€¢ Timer countdownâ”‚\n    â”‚ â€¢ Send OTP      â”‚      â”‚                  â”‚\n    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n             â”‚                        â”‚\n             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                          â”‚\n                          â–¼\n                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n                 â”‚ Firebase Auth   â”‚\n                 â”‚                 â”‚\n                 â”‚ â€¢ verifyPhone() â”‚\n                 â”‚ â€¢ signInWithCredâ”‚\n                 â”‚ â€¢ Create user   â”‚\n                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                          â”‚\n                          â–¼\n                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n                 â”‚ Cloud Firestore â”‚\n                 â”‚                 â”‚\n                 â”‚ â€¢ Save profile  â”‚\n                 â”‚ â€¢ Create notif  â”‚\n                 â”‚ â€¢ Store phone   â”‚\n                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                          â”‚\n                          â–¼\n                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n                 â”‚ Firebase Messg  â”‚\n                 â”‚                 â”‚\n                 â”‚ â€¢ Get FCM token â”‚\n                 â”‚ â€¢ Send notifs   â”‚\n                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n---\n\n## 10. Decision Tree: OTP Verification\n\n```\n                    Start Verification\n                            â”‚\n                            â–¼\n                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n                    â”‚ Code entered?â”‚\n                    â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜\n                       NO     YES\n                       â”‚      â”‚\n                       â”‚      â–¼\n                       â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n                       â”‚   â”‚ 6 digits?   â”‚\n                       â”‚   â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”˜\n                       â”‚      NO     YES\n                       â”‚      â”‚      â”‚\n                       â”‚      â–¼      â–¼\n                       â”‚   ERROR  Send to\n                       â”‚            Firebase\n                       â”‚            â”‚\n                       â”‚            â–¼\n                       â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n                       â”‚      â”‚ Code valid?  â”‚\n                       â”‚      â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜\n                       â”‚         NO     YES\n                       â”‚         â”‚      â”‚\n                       â”‚         â–¼      â–¼\n                       â”‚      ERROR  SUCCESS\n                       â”‚         â”‚      â”‚\n                       â”‚         â–¼      â–¼\n                       â”‚      Retry   Save\n                       â”‚      or     Profile\n                       â”‚      Resend    â”‚\n                       â”‚               â–¼\n                       â”‚          Redirect\n                       â”‚          to Home\n                       â”‚\n                       â””â”€â”€â”€â”€â–º Continue Waiting\n                              for input\n```\n\n---\n\n**Diagrams created:** November 25, 2025  \n**All flows verified:** âœ…  \n**Ready for reference:** âœ…\n"